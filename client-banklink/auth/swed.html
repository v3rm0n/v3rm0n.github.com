<!DOCTYPE html>
<html>
	<head>
		<title>Swedbanki autentimine</title>
		<meta charset="UTF-8" />
		<link type="text/css" rel="stylesheet" href="https://current.bootstrapcdn.com/bootstrap-v204/css/bootstrap-combined.min.css"></link>
		<script type="text/javascript" src="../js/rsasign/jsbn.js"></script>
		<script type="text/javascript" src="../js/rsasign/jsbn2.js"></script>
		<script type="text/javascript" src="../js/rsasign/rsa.js"></script>
		<script type="text/javascript" src="../js/rsasign/rsa2.js"></script>
		
		<script type="text/javascript" src="../js/rsasign/sha1.js"></script>
		<script type="text/javascript" src="../js/rsasign/sha256.js"></script>
		<script type="text/javascript" src="../js/rsasign/sha512.js"></script>
		<script type="text/javascript" src="../js/rsasign/md5.js"></script>
		<script type="text/javascript" src="../js/rsasign/ripemd160.js"></script>
		<script type="text/javascript" src="../js/rsasign/base64.js"></script>
		
		<script type="text/javascript" src="../js/rsasign/rsapem-1.1.min.js"></script>
		<script type="text/javascript" src="../js/rsasign/rsasign-1.2.min.js"></script>
		<script type="text/javascript" src="../js/rsasign/asn1hex-1.1.min.js"></script>
		<script type="text/javascript" src="../js/rsasign/x509-1.1.min.js"></script>
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
		<script type="text/javascript" src="https://current.bootstrapcdn.com/bootstrap-v204/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="../js/scripts.js"></script>
		<script type="text/javascript" src="../js/swed.js"></script>
		<script type="text/javascript">
			//Initialize
			$(function(){
				//Initialize packet from request
				request = Packet.init();
				//Create table with packet parameters
				$("#request").html(request.html());
				//Verfiy request packet
				if(!request.verify()){
					$("#bankForm").append("<div class='alert alert-error'>Verification failed!</div>");
				}
				$("#bankForm").submit(function(){
					var response = request.response($("#firstname").val(),$("#lastname").val(),$("#idcode").val());
					$("#bankForm").attr("method", (getUrlParam('USE_GET') == undefined ? "POST":"GET"));
					$.each(response.parameters, function(i,param){
						$("<input />").attr("type", "hidden")
						    .attr("name", param.name)
						    .attr("value", param.value)
						    .appendTo('#bankForm');
					    });
					$("#bankForm").attr("action", request.getParam("VK_RETURN"));
				});
			});
		</script>
	</head>
	<body>
		<div class="container-fluid">
			<div class="row-fluid">
				<div class="span4">&nbsp;</div>
				<div class="span4">
					<form id="bankForm" class="form-horizontal">
						<fieldset>
							<legend>Swedbanki autentimine <a href="#paramsModal" data-toggle="modal" class="btn btn-inverse btn-mini">Parameetrid</a></legend>
							<div class="control-group">
								<label class="control-label" for="idcode">Isikukood</label>
								<div class="controls">
									<input type="text" class="input-xlarge" id="idcode" name="idcode" value="35403040276">
									<p class="help-block">Isikukood</p>
								</div>
							</div>
							<div class="control-group">
								<label class="control-label" for="firstname">Eesnimi</label>
								<div class="controls">
									<input type="text" class="input-xlarge" id="firstname" name="firstname" value="Aadu">
									<p class="help-block">Sisesta oma eesnimi</p>
								</div>
							</div>
							<div class="control-group">
								<label class="control-label" for="lastname">Perenimi</label>
								<div class="controls">
									<input type="text" class="input-xlarge" id="lastname" name="lastname" value="Kadakas">
									<p class="help-block">Sisesta oma perenimi</p>
								</div>
							</div>
							<div class="form-actions">
								<button type="submit" class="btn btn-primary">Sisene</button>
							</div>
						</fieldset>
					</form>
					<div class="modal hide" id="paramsModal">
					  <div class="modal-header">
					    <button type="button" class="close" data-dismiss="modal">Ã—</button>
					    <h3>Parameetrid</h3>
					  </div>
					  <div class="modal-body" id="request">
					  </div>
					</div>
				</div>
			</div>
		</div>
	</body>
</html>

